from pwn import *
import ctypes
import time

# Connect to the challenge
r = remote("jupiter.challenges.picoctf.org", 8311)

# Load C's rand/srand
libc = ctypes.CDLL("libc.so.6")

# Sync our seed to the current second
seed = int(time.time())
libc.srand(seed)

# Predict the next 30 numbers
guesses = [(libc.rand() & 0xF) for _ in range(30)]

# Now send them all, reading prompts in between
for guess in guesses:
    r.recvuntil(b"Guess the height:")
    r.sendline(str(guess).encode())

# Print any remaining output (flag)
print(r.recvall().decode())
